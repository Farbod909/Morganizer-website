<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
    <title>MorTeam</title>
    <link href='http://fonts.googleapis.com/css?family=Open+Sans:700,300,400' rel='stylesheet' type='text/css'>
    <link href='http://fonts.googleapis.com/css?family=Roboto' rel='stylesheet' type='text/css'>
    <link href='http://fonts.googleapis.com/css?family=Exo+2:400,300,200' rel='stylesheet' type='text/css'>
    <link href='http://fonts.googleapis.com/css?family=Titillium+Web' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/css/bootstrap-theme.min.css">
    <link href="jbox/themes/TooltipDark.css" rel="stylesheet">
    <link rel="stylesheet" href="css/index.css" type="text/css">
    <link href="jbox/jBox.css" rel="stylesheet">
    <script src="http://js.nicedit.com/nicEdit-latest.js" type="text/javascript"></script>
    <script type="text/javascript">
        bkLib.onDomLoaded(function() {

            new nicEditor({
                buttonList: ['bold', 'italic', 'underline', 'left', 'center', 'right', 'justify', 'removeformat', 'hr', 'upload']
            }).panelInstance('main_textarea');

        });
    </script>
    <script type="text/javascript">
        if (localStorage.userToken == undefined) {
            location = "login";
        }
    </script>
    <script src="js/spin.js"></script>
    <script type="text/javascript">
        var loadingDiv = document.createElement("div");
        loadingDiv.className = "loading_circle";
        loadingDiv.id = "loading_circle";
    </script>

</head>

<body class="index_body">
    <div id="audio-files" style="display: none;">
        <audio id="click-sound">
            <source src="jbox/audio/bling2.wav" type="audio/wav" />
        </audio>
    </div>
    <!-- NAVIGATION BAR -->
    <div class="nav_dropdown">
      <p onclick="location='index'" style="background-color: orange">Home</p>
      <p onclick="location='chat'">Chat</p>
      <p onclick="location='drive'">Drive</p>
      <p onclick="location='cal'">Calendar</p>
      <p onclick="location='networks'">Networks</p>
    </div>
    <div class="navigation_bar">
        <ul id="navbar_list">
          <li class="navbar_item navbar_title navbar_title_index">
              MorTeam
          </li>
          <li class="navbar_item searchbox_list_item">
              <input type="text" placeholder="search" class="searchbox"></input>
              <div class="search_drop">
                <ul>
                  <li>
                    under<br/>
                    construction
                  </li>
                  <li>
                    under<br/>
                    construction
                  </li>
                  <li>
                    under<br/>
                    construction
                  </li>
                  <li>
                    under<br/>
                    construction
                  </li>
                </ul>
              </div>
          </li>
          <li class="navbar_item glyph_link chat_btn menu_btn" onclick="location='chat'">
              <span class="glyphicon glyphicon-comment"></span>
          </li>
          <li class="navbar_item glyph_link drive_btn menu_btn" onclick="location='drive'">
              <span class="glyphicon glyphicon-hdd"></span>
          </li>
          <li class="navbar_item glyph_link cal_btn menu_btn" onclick="location='cal'">
              <span class="glyphicon glyphicon-calendar"></span>
          </li>
          <li class="navbar_item glyph_link networks_btn menu_btn" onclick="location='networks'">
              <span class="glyphicon glyphicon-globe"></span>
          </li>
          <div class="navbar_item right_links">
            <li class="navbar_item glyph_link menu">
                <span class="glyphicon glyphicon-menu-hamburger"></span>
            </li>
            <li class="navbar_item glyph_link" id="notif_button">
                <span class="glyphicon glyphicon-inbox"></span>
                <span class="unseen_count bold">3</span>
            </li>
            <img class="profile_id" id="small_prof_pic" src="./images/user.jpg"></img>
            <span class="profile_name" id="name_link"></span>
          </div>
        </ul>
    </div>
    <!-- <div class="triangle_thing_notif hidden"></div>
    <div class="triangle_thing_prof hidden"></div> -->
    <div id="notif_drop" class="hidden">
        <ul>
            <li class="notif_list_item">hey</li>
            <li class="notif_list_item">hi</li>
            <li class="notif_list_item">ho</li>
        </ul>
    </div>
    <div id="prof_drop" class="hidden">
        <ul>
            <li class="notif_list_item" onclick="location='user?user='+localStorage.username;">View Profile and Settings</li>
            <li class="notif_list_item" id="logout_button">Log Out</li>
        </ul>
    </div>
    <div class="hidden" id="darken"></div>
    <!-- END OF NAVIGATION BAR -->
    <!-- BODY -->
    <div class="announcements_container" style="margin-top: 60px;">

        <div class="announcements_left">
          <p onclick="location='profile'">View Profile</p>
          <p id="logout_button">Log Out</p>
          <p id="team_button">MorTorq</p>
          <hr>
          <div id="your_scopes">
              <h5 style="margin-bottom: 15px;">Your Subdivisions</h5>
          </div>
          <hr>
          <div id="public_scopes">
              <h5 style="margin-bottom: 15px;">Public Subdivisions</h5>
          </div>
          <hr>
          <div id="invited_scopes">
              <h5 style="margin-bottom: 15px;">Subdivision Invites</h5>
          </div>
          <hr>
          <p class="new_pu_scope"><span class="glyphicon glyphicon-plus"></span> Make a Subdivision</p>
          <hr>
          <span>Â© 2015 MorTeam</span>
        </div>
        <div class="announcements_center">
          <div class="post_announcement cf">
              <textarea class="announcement_textarea" id="main_textarea" placeholder="Make an announcement..."></textarea>
              <input type="button" class="announcement_post_button" value="Post"></input>
              <div class=" announcement_audience_button btn-group">
                  <button class="button dropdown-toggle" data-toggle="dropdown"><span class="audience_selection">Everyone</span>
                      <span class="caret"></span>
                  </button>
                  <ul class="dropdown-menu audience_drop">
                      <li class="audience_item selected first_audience">Everyone</li>
                      <li class="audience_item">Build</li>
                      <li class="audience_item">Programming</li>
                      <li class="audience_item">Business</li>
                      <li class="audience_item custom_audience"><span class="glyphicon glyphicon-cog"></span>&nbsp;Custom</li>
                  </ul>
              </div>
          </div>
          <div class="announcements_list">
              <!-- <div class="announcement" data-postNum="1">
              <div class="announcement_top">
                <img id="medium_prof_pic" src="./images/user.jpg"></img>
                <span class="announcement_poster">Farbod Rafezy</span>
              </div>
              <span class="glyphicon glyphicon-remove delete_icon"></span><br>
              the words go here
            </div> -->
          </div>
        </div>
        <div class="announcements_right">
          <div class="ad" style="margin-top: 0px; position: fixed;"></div>
        </div>

    </div>
    <!-- END OF BODY -->
    <script src="http://code.jquery.com/jquery-1.11.3.min.js"></script>
    <script src="jbox/jBox.min.js"></script>
    <script type="text/javascript" src="js/socket.io.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/js/bootstrap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.isotope/2.2.1/isotope.pkgd.min.js"></script>
    <script type="text/javascript" src="js/velocity.min.js"></script>
    <script type="text/javascript" src="js/autosize.js"></script>
    <script type="text/javascript">
        autosize(document.querySelectorAll('textarea'));
    </script>
    <script type="text/javascript">
        // FUNCTION DEFINITIONS

        var didClickNew = true;

        function makeScope(){
            var status = "private";
            if ($(".public_scope").hasClass("selected")){
                status = "public";
            }
            var usersBadges = $("p.clicked");
            var users = [];
            for (var i = 0; i < usersBadges.length; i++) {
                users.push($(usersBadges[i]).attr("data-username"));
            }
            var scopeName = $(".scope_name").val();
            request("POST", "/f/makescope", JSON.stringify({"user":localStorage.username, "scopeName":scopeName, "members":users, "status":status, "teamCode":localStorage.teamCode}), function(responseText){
                if (responseText == "success"){
                    $("#your_scopes").append('<p class="scope_link"><span class="glyphicon glyphicon-screenshot"></span> <span class="scopeName">'+scopeName+'</span></p>')
                    if (status == "public"){
                        $("#public_scopes").append('<p class="scope_link"><span class="glyphicon glyphicon-screenshot"></span> <span class="scopeName">'+scopeName+'</span></p>')
                    }
                }
            });
        }

        function loadPublicScopes(){
            request("POST", "/f/getpublicscopesforteam", JSON.stringify({"user":localStorage.username, "teamCode":localStorage.teamCode}), function(responseText){
                var scopes = JSON.parse(responseText);
                for (var i = 0; i < scopes.length; i++){
                    $("#public_scopes").append('<p class="scope_link"><span class="glyphicon glyphicon-screenshot"></span> <span class="scopeName">'+scopes[i].scopeName+'</span></p>')
                }
            });
        }

        function loadYourScopes(){
            request("POST", "/f/getyourscopes", JSON.stringify({"user":localStorage.username, "teamCode":localStorage.teamCode}), function(responseText){
                var scopes = JSON.parse(responseText);
                for (var i = 0; i < scopes.length; i++){
                    $("#your_scopes").append('<p class="scope_link"><span class="glyphicon glyphicon-screenshot"></span> <span class="scopeName">'+scopes[i].scopeName+'</span></p>')
                }
            });
        }

        function loadInvites(){
            request("POST", "/f/getscopeinvites", JSON.stringify({"user":localStorage.username, "teamCode":localStorage.teamCode}), function(responseText){
                var scopes = JSON.parse(responseText);
                for (var i = 0; i < scopes.length; i++){
                    $("#invited_scopes").append('<p class="scope_invite"><span class="glyphicon glyphicon-screenshot"></span> <span class="scopeName">'+scopes[i].scopeName+'</span></p>')
                }
            });
        }

        function checkIfHasTeams(){
            request("POST", "/f/getteams", JSON.stringify({"user":localStorage.username}), function(responseText){
                var teams = JSON.parse(responseText);
                if (teams.length == 0){
                    location="void";
                }
                else {
                    //chooses first team in list of teams
                    localStorage.teamName = teams[0].teamName;
                    localStorage.teamCode = teams[0].teamCode;
                    localStorage.teamNumber = teams[0].teamNumber;
                    updateToken();
                }
            });
        }
        function createPost(text) {
            //var title = localStorage.title
            var months = ['January', 'February', 'March', 'April', 'May', 'June', 'July', 'August', 'September', 'October', 'November', 'December']
            var now = new Date();
            var nameDate = localStorage.firstName + ' ' + localStorage.lastName + ' - ' + months[now.getMonth()] + ' ' + now.getDate() + ', ' + now.getFullYear() + ' - ' + getTimeNow();
            var postNum = 1;
            if ($('.announcement').first().length > 0) {
                postNum = parseInt($('.announcement').first().attr('data-postNum')) + 1;
            }
            var xhr = new XMLHttpRequest();
            xhr.open("POST", "/f/announce", true);
            xhr.onreadystatechange = function() {
                if (xhr.readyState == 4 && xhr.status == 200) {
                    if (xhr.responseText == "success") {
                        var $newMsg = $('<div class="announcement" data-postNum="' + postNum + '"><div class="announcement_top"><img id="medium_prof_pic" src="/f/getPic?user='+localStorage.username+'" onError="this.src=\'./images/user.jpg\'""></img><span class="announcement_poster">' +
                            nameDate + '</span></div><span class="glyphicon glyphicon-remove delete_icon"></span><br>' + text.replace(/\n\r?/g, '<br />') + '</div>')
                        $('.announcements_list').prepend($newMsg).isotope('prepended', $newMsg)

                        document.getElementById('main_textarea').value = "";
                        $('#main_textarea').css("height", "56px");
                        getPic(localStorage.username, $("#medium_prof_pic"));
                    }
                }
            };
            //var code = localStorage.teamCode;
            xhr.send(JSON.stringify({
                "user": localStorage.username,
                "nameDate": nameDate,
                "teamCode": localStorage.teamCode,
                "text": text.replace(/\n\r?/g, '<br />').replace(/'/g, "''"),
                "token":localStorage.userToken
            }));
        }

        function getAnnouncements() {
            //var code = localStorage.teamCode
            //var title = localStorage.title
            var xhr = new XMLHttpRequest();
            xhr.open("POST", "/f/getannouncements", true);
            xhr.onreadystatechange = function() {
                if (xhr.readyState == 4 && xhr.status == 200) {
                    if (xhr.responseText != "fail") {
                        var announcements = JSON.parse(xhr.responseText);
                        if (announcements.length == 0){
                          //stop spin
                        }
                        for (var i = announcements.length - 1; i > -1; i--) {
                            if (i == 0){
                              //stop spin
                              spinner.stop();
                            }
                            var nameDate = announcements[i].nameDate;
                            var user = announcements[i].user;
                            var text = announcements[i].text.replace(/\n\r?/g, '<br />');
                            var postNum = announcements[i].postNum;
                            if (user == localStorage.username){//Add if leader or admin
                                $('.announcements_list').append('<div class="announcement" data-postNum="' + postNum + '"><div class="announcement_top"><img id="medium_prof_pic" class="poster_pic' + i +
                                    '" src="/f/getPic?user='+user+'" onError="this.src=\'./images/user.jpg\'"></img><span class="announcement_poster">' + nameDate + '</span></div><span class="glyphicon glyphicon-remove delete_icon"></span><br>' + text.replace(/\n\r?/g, '<br />') + '</div>')
                            }
                            else {
                                $('.announcements_list').append('<div class="announcement" data-postNum="' + postNum + '"><div class="announcement_top"><img id="medium_prof_pic" class="poster_pic' + i +
                                    '" src="/f/getPic?user='+user+'" onError="this.src=\'./images/user.jpg\'"></img><span class="announcement_poster">' + nameDate + '</span></div><br>' + text.replace(/\n\r?/g, '<br />') + '</div>')
                            }
                            document.getElementById('main_textarea').value = "";
                            $('#main_textarea').css("height", "56px");
                            /*var prof_pic_class = ".poster_pic" + i;
                            var target = $(prof_pic_class);
                            getPic(user, target);*/
                        }
                        setTimeout(function(){
                            $ann = $(".announcements_list").isotope({
                                itemSelector: ".announcement",
                                layoutMode: "vertical"
                            });
                        }, 1);
                    }
                }
            };
            xhr.send(JSON.stringify({
                "user": localStorage.username,
                "teamCode": localStorage.teamCode
            }));
        }

        function deletePost() {
            //
        }
        function loadUsersOnScopeModal(modal) {
            var xhr = new XMLHttpRequest();
            xhr.open("POST", "/f/getteammates", true);
            xhr.onreadystatechange = function() {
                if (xhr.readyState == 4 && xhr.status == 200) {
                    if (xhr.responseText != "fail") {
                        var users = JSON.parse(xhr.responseText);
                        people = users;
                        var content = "";
                        for (var i = 0; i < people.length; i++) {
                            var person = people[i].first + " " + people[i].last;
                            var nameP = "<p class='selected_scope_member' data-username='" + people[i].user + "'>" + person + "</p>"
                            content += nameP;
                        }
                        var modal_content = '<input type="text" class="scope_name" placeholder="Subdivision Name"></input><br/><p class="scope_type public_scope selected">Public</p><p class="scope_type private_scope">Private</p><span class="glyphicon glyphicon-question-sign scope_help" title="A public subdivision can be seen and<br/> joined by anyone in the team, but joining<br/> a private subdivision requires an invitation."></span><br/>Invite some initial members:<br/><input type="text" placeholder="Search Names..." id="select_scope_members"></input><br/><div id="selected_scope_members">' +
                        content + '</div><br/><input type="button" class="button make_scope_button" value="Make Subdivision"></input>'
                        modal.setContent(modal_content);
                        $('.scope_help').jBox('Tooltip', {
                            delayOpen: 0,
                            delayClose: 300,
                            theme: "TooltipDark",
                            position: {
                                y: 'bottom'
                            }
                        });
                    }
                }
            };
            xhr.send(JSON.stringify({
                "user": localStorage.username,
                "teamCode":localStorage.teamCode
            }));
        }
        function loadUsersOnAudienceModal(modal) {
            var xhr = new XMLHttpRequest();
            xhr.open("POST", "/f/getteammates", true);
            xhr.onreadystatechange = function() {
                if (xhr.readyState == 4 && xhr.status == 200) {
                    if (xhr.responseText != "fail") {
                        var users = JSON.parse(xhr.responseText);
                        people = users;
                        var content = "";
                        for (var i = 0; i < people.length; i++) {
                            var person = people[i].first + " " + people[i].last;
                            var nameP = "<p class='selected_audience_member' data-username='" + people[i].user + "'>" + person + "</p>"
                            content += nameP;
                        }
                        var modal_content = 'Please select the audience of the post:<br/><input type="text" placeholder="Search Names..." id="select_audience_members"></input><br/><div id="selected_audience_members">' +
                        content + '</div><br/><input type="button" class="button make_audience_button" value="OK"></input>'
                        modal.setContent(modal_content);
                    }
                }
            };
            xhr.send(JSON.stringify({
                "user": localStorage.username,
                "teamCode": localStorage.teamCode
            }));
        }
        $(document).ready(function() {
            checkIfHasTeams();

            document.body.appendChild(loadingDiv);

            spinnerOpts = {
                lines: 13 // The number of lines to draw
                    ,
                length: 0 // The length of each line
                    ,
                width: 20 // The line thickness
                    ,
                radius: 42 // The radius of the inner circle
                    ,
                scale: .5 // Scales overall size of the spinner
                    ,
                corners: 1 // Corner roundness (0..1)
                    ,
                color: 'orange' // #rgb or #rrggbb or array of colors
                    ,
                opacity: 0.25 // Opacity of the lines
                    ,
                rotate: 0 // The rotation offset
                    ,
                direction: 1 // 1: clockwise, -1: counterclockwise
                    ,
                speed: 1 // Rounds per second
                    ,
                trail: 60 // Afterglow percentage
                    ,
                fps: 20 // Frames per second when using setTimeout() as a fallback for CSS
                    ,
                zIndex: 2e9 // The z-index (defaults to 2000000000)
                    ,
                className: 'spinner' // The CSS class to assign to the spinner
                    ,
                top: '30%' // Top position relative to parent
                    ,
                left: '0%' // Left position relative to parent
                    ,
                shadow: false // Whether to render a shadow
                    ,
                hwaccel: false // Whether to use hardware acceleration
                    ,
                position: 'absolute' // Element positioning
            }

            spinner = new Spinner(spinnerOpts).spin(loadingDiv);

            audience_modal = new jBox('Modal', {
              attach: $('.custom_audience'),
              title: 'Custom Audience',
              width: 350,
              height: 340,
              onOpen: function() {
                  didClickNew = false;
                  loadUsersOnAudienceModal(audience_modal);
                  $(document).on("keyup", '#select_audience_members', function() {
                    var val = $.trim($(this).val()).replace(/ +/g, ' ').toLowerCase();
                    $('#selected_audience_members p').show().filter(function() {
                        var text = $(this).text().replace(/\s+/g, ' ').toLowerCase();
                        console.log(!~text.indexOf(val));
                        return !~text.indexOf(val);
                    }).hide();
                  });
                  $(document).on("click", '.make_audience_button', function() {
                    // CODE TO CREATE FOLDER HERE
                    if (!didClickNew){
                            didClickNew = true;
                            var usersBadges = $("p.clicked");
                            var users = [];
                            for (var i = 0; i < usersBadges.length; i++) {
                                users.push($(usersBadges[i]).attr("data-username"));
                            }
                            // request("POST", "/f/newfolder", JSON.stringify({"user":localStorage.username, "people":users, "folderName":nameOfFolder}), function(responseText){
                            //     var li = $(document.createElement("li"));
                            //     var span = $(document.createElement("span"));
                            //     li.append(span);
                            //     li.attr("class", "drive_name");
                            //     span.attr("id", "make_drive");
                            //     span.attr("data-folderid", responseText);
                            //     span.attr("class", "glyphicon glyphicon-folder-open");
                            //     li.append(folder_name);
                            //     $('.folders_list').append(li);
                            //     folder_modal.close();
                            // });
                        }
                  });
              }
            });
            loadUsersOnAudienceModal(audience_modal);
            $(document).on("click", ".selected_audience_member", function() {
                // do stuff with $(this) when a name has been clicked in group_modal
                if ($(this).hasClass("clicked")) {
                    $(this).removeClass("clicked");
                } else {
                    $(this).addClass('clicked');
                }
            });


            scope_modal = new jBox('Modal', {
              title: 'New Subdivision',
              width: 350,
              height: 373,
              onOpen: function() {
                  didClickNew = false;
                  loadUsersOnScopeModal(scope_modal);
                  $(document).on("keyup", '#select_scope_members', function() {
                    var val = $.trim($(this).val()).replace(/ +/g, ' ').toLowerCase();
                    $('#selected_scope_members p').show().filter(function() {
                        var text = $(this).text().replace(/\s+/g, ' ').toLowerCase();
                        console.log(!~text.indexOf(val));
                        return !~text.indexOf(val);
                    }).hide();
                  });
                  $(document).one("click", '.make_scope_button', function() {
                    // CODE TO CREATE SCOPE HERE
                        if (didClickNew == false){
                            didClickNew = true;
                            makeScope();
                            scope_modal.close();
                        }
                  });
              }
            });
            loadUsersOnScopeModal(scope_modal);

            $(document).on("click", ".new_pu_scope", function(){
              scope_modal.open();
            });
            $(document).on("click", ".new_pr_scope", function(){
              scope_modal.open();
            });

            $(document).on("click", ".selected_scope_member", function() {
                // do stuff with $(this) when a name has been clicked in group_modal
                if ($(this).hasClass("clicked")) {
                    $(this).removeClass("clicked");
                } else {
                    $(this).addClass('clicked');
                }
            });
            $(document).on("click", ".scope_type", function(){
              $(".scope_type").removeClass("selected");
              $(this).addClass("selected");
            });
            $(document).on("click", ".scope_help", function(){

            })


            var audience = "Everyone";

            $(document).on("click", ".audience_item:not(.custom_audience)", function(){
              $(".audience_item").removeClass("selected");
              $(this).addClass("selected");
              $(".audience_selection").html( $(this).html() );
              audience = $(this).html();
            });

            $('.announcement_post_button').click(function() {
                var message = (new nicEditors.findEditor('main_textarea')).getContent();
                createPost(message.replace("(<((?!br|a|/a|img|b|/b|i|/i|u|/u|div|/div|hr)[^>]+)>)", "").replace(/(<div\s+.*?class=").*?(".*)/gi, ""));
                nicEditors.findEditor('main_textarea').setContent('');
            });
            $(document).on("click", ".delete_icon", function() {
                if (window.confirm("Are you sure?")) {
                    var target = $(this).parent();
                    var data = JSON.stringify({
                        "postNum": parseInt(target.attr('data-postNum')),
                        "user": localStorage.username,
                        "teamCode":localStorage.teamCode,
                        "token": localStorage.userToken
                    });
                    $.post("/f/deletePost", data, function(response) {
                        console.log(response);
                        if (response == "success") {
                            $ann.isotope('remove', target).isotope();
                        }
                    });
                }
            });
            $(document).on("click", "#team_button", function(){
              location="team";
            });


        });
        $(window).load(function(){

            getAnnouncements(); // getting announcements is first priority on this page

            console.log(localStorage.teamCode);
            loadInvites();
            loadPublicScopes();
            loadYourScopes();
          $("div.nicEdit-main").addClass('wordwrap');
          var textareaWidthNum;
          var textareaWidth;
          $(window).resize(function(){
            textareaWidthNum = $(".post_announcement").width();
            textareaWidth = textareaWidthNum + "px";
            $(".nicEdit-main").css("width", textareaWidth);
            $(".post_announcement").children().not(".announcement_post_button").not(".announcement_audience_button").css("width", textareaWidth);
            console.log($(".nicEdit-main").css("width"));
          });

          // setTimeout(function(){
          //     $ann = $(".announcements_list").isotope({
          //         itemSelector: ".announcement",
          //         layoutMode: "vertical"
          //     });
          // }, 1);
          $(document).on("click", ".scope_link", function(){
            location="subdivision";
          });

          $(".searchbox").keyup(function(){
            if( $(".searchbox").val() != "" ){
              $(".search_drop").show();
            }else{
              $(".search_drop").hide();
            }
          })
        })
        window.onunload = function() {};
    </script>
    <script type="text/javascript" src="js/main.js"></script>
    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-66914799-1', 'auto');
      ga('send', 'pageview');

    </script>

</body>

</html>
